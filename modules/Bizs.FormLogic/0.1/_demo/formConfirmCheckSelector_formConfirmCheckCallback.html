<!doctype html>
<html>
    <head>
        <meta charset=utf-8 />
        <title>Open JQuery Components Library - suches</title>
        <style>
            body{
                margin: 20px 40px;
            }

            dt { font-weight: bold; margin: 10px auto; }
            dd { line-height: 24px; }
        </style>
        <link href='../../../../modules/JC.Valid/0.2//res/default/style.css' rel='stylesheet' />
        <link href='../../../../modules/JC.Calendar/0.2/res/default/style.css' rel='stylesheet' />
        <link href='../../../../modules/JC.Panel/0.1/res/default/style.css' rel='stylesheet' />

        <script src="../../../../lib.js"></script>
        <script src="../../../../config.js"></script>
        <script>
            JC.debug = true;

            requirejs( [ 'JC.Calendar', 'Bizs.FormLogic', 'plugins.json2' ]
            , function( Calendar, FormLogic ){
            });

            function formBeforeProcess( _evt, _ins ){
                var _form = $(this);
                JC.log( 'formBeforeProcess', new Date().getTime() );
            }

            function formAfterProcess( _evt, _ins ){
                var _form = $(this);
                JC.log( 'formAfterProcess', new Date().getTime() );
                //return false;
            }

            function formConfirmCheckCallback( _trigger, _evt, _ins ){
                var _form = $(this);
                JC.log( 'formConfirmCheckCallback', new Date().getTime() );
                return _form.find('td.js_confirmCheck input[value=0]:checked').length;
            }

        </script>
    </head>    
    <body>

        <dl class="defdl">
            <dt>Bizs.FormLogic, formConfirmCheckSelector, 选择拒绝的时候才显示二次确认</dt>
            <dd>
                <dl>
                    <form action="./data/handler.php" method="POST" target="postIframe" 
                        class="js_bizsFormLogic" 
                        formtype="ajax" 
                        formbeforeprocess="formBeforeProcess" 
                        formafterprocess="formAfterProcess" 
                        formajaxdone="formAjaxDone" 
                        formajaxdoneaction="?donetype=system"
                        >
                        <table>
                            <tbody>
                                <tr>
                                    <th>审批操作：</th>
                                    <td class="js_confirmCheck">
                                        <input type="radio" name="is_passed" value="1" checked="">&nbsp;通过
                                        <input type="radio" name="is_passed" value="0">&nbsp;拒绝
                                    </td>
                                </tr>
                                <tr>
                                    <th>审批批注：</th>
                                    <td>
                                        <textarea class="txt txt-w280" name="remark" reqmsg="审批批注" maxlength="500">test</textarea>
                                    </td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td>
                                        <button type="submit" class="btn btn-1" 
                                            formsubmitconfirm="是否执行审批操作?"
                                            formConfirmCheckSelector="<form td.js_confirmCheck input[value=0]:checked"
                                         >提交</button>
                                        <button type="button" class="btn btn-2" buttonreturnurl="?custom=cancel">取消</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </dl>
            </dd>
        </dl>

        <dl class="defdl">
            <dt>Bizs.FormLogic, formConfirmCheckCallback, 选择拒绝的时候才显示二次确认</dt>
            <dd>
                <dl>
                    <form action="./data/handler.php" method="POST" target="postIframe" 
                        class="js_bizsFormLogic" 
                        formtype="ajax" 
                        formbeforeprocess="formBeforeProcess" 
                        formafterprocess="formAfterProcess" 
                        formajaxdone="formAjaxDone" 
                        formajaxdoneaction="?donetype=system"
                        >
                        <table>
                            <tbody>
                                <tr>
                                    <th>审批操作：</th>
                                    <td class="js_confirmCheck">
                                        <input type="radio" name="is_passed" value="1" checked="">&nbsp;通过
                                        <input type="radio" name="is_passed" value="0">&nbsp;拒绝
                                    </td>
                                </tr>
                                <tr>
                                    <th>审批批注：</th>
                                    <td>
                                        <textarea class="txt txt-w280" name="remark" reqmsg="审批批注" maxlength="500">test</textarea>
                                    </td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td>
                                        <button type="submit" class="btn btn-1" 
                                            formsubmitconfirm="是否执行审批操作?"
                                            formConfirmCheckCallback="formConfirmCheckCallback"
                                         >提交</button>
                                        <button type="button" class="btn btn-2" buttonreturnurl="?custom=cancel">取消</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </dl>
            </dd>
        </dl>


        <iframe src="about:blank" name="postIframe" width="500" height="400" ></iframe>
    </body>
</html>
