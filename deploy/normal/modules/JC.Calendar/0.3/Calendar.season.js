(function(e,t){e("JC.Calendar.season",["JC.Calendar.date"],function(){function e(e){this._selector=e}function t(e){this._model=e}return JC.Calendar.seasonTpl="",JC.Calendar.SeasonModel=e,JC.Calendar.SeasonView=t,JC.Calendar.clone(e,t),JC.f.extendObject(e.prototype,{layout:function(){var e=$("#UXCCalendar_season");return e.length||(e=$(JC.Calendar.seasonTpl||this.tpl).hide(),e.attr("id","UXCCalendar_season").hide().appendTo(document.body)),e},tpl:['<div id="UXCCalendar_season" class="UXCCalendar UXCCalendar_week UXCCalendar_season" >','    <div class="UHeader">','        <button type="button" class="UButton UNextYear">&nbsp;&gt;&gt;&nbsp;</button>','        <button type="button" class="UButton UPreYear">&nbsp;&lt;&lt;&nbsp;</button>','        <select class="UYear" style=""></select>',"    </div>",'    <table class="UTable UTableBorder">',"        <tbody></tbody>","    </table>",'    <div class="UFooter">','        <button type="button" class="UConfirm">确定</button>','        <button type="button" class="UClear">清空</button>','        <button type="button" class="UCancel">取消</button>',"    </div>","</div>"].join(""),month:function(){var e=0,t,n;return(t=this.layout().find("td.cur a[dstart]")).length&&(n=new Date)&&(n.setTime(t.attr("dstart")),e=n.getMonth()),e},selectedDate:function(){var e,t,n;return t=this.layout().find("td.cur"),t.length&&!t.hasClass("unable")&&(n=t.find("a[dstart]"))&&(e={start:new Date,end:new Date},e.start.setTime(n.attr("dstart")),e.end.setTime(n.attr("dend"))),e}}),JC.f.extendObject(t.prototype,{_buildBody:function(e){var t=this,n=e.date,r=t._model.layout(),i=(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())).getTime(),s=0,o=[],u,a,f,l,c,h=n.getFullYear(),p=4,d=JC.Calendar.lastIpt,v=JC.f.parseBool(d.attr("currentcanselect")),m=e.minvalue?JC.f.cloneDate(e.minvalue):null,g=e.maxvalue?JC.f.cloneDate(e.maxvalue):null,y;if(g&&v){var y=g.getMonth()+1,b;y%3!==0&&(g.setDate(1),g.setMonth(y+(3-y%3-1))),g.setDate(JC.f.maxDayOfMonth(g))}m&&v&&(y=m.getMonth()+1,b,m.setDate(1),m.setMonth(m.getMonth()-(3-y%3))),o.push("<tr>");for(var w=1,E=4;w<=E;w++){l=new Date(h,w*3-3,1),c=new Date(h,w*3-1,1),c.setDate(JC.f.maxDayOfMonth(c));var S=JC.Calendar.cnUnit.charAt(w%10);w>10&&(S="十"+S),f=JC.f.printf("{0}年 第{1}季度\n开始日期: {2} (周{4})\n结束日期: {3} (周{5})",h,JC.Calendar.getCnNum(w),JC.f.formatISODate(l),JC.f.formatISODate(c),JC.Calendar.cnWeek.charAt(l.getDay()%7),JC.Calendar.cnWeek.charAt(c.getDay()%7)),u=[],m&&l.getTime()<m.getTime()&&u.push("unable"),g&&c.getTime()>g.getTime()&&u.push("unable"),n.getTime()>=l.getTime()&&n.getTime()<=c.getTime()&&u.push("cur"),i>=l.getTime()&&i<=c.getTime()&&u.push("today"),o.push(JC.f.printf('<td class="{0}"><a href="javascript:" title="{1}" dstart="{3}" dend="{4}" month="{5}" season="{5}" >{2}季度</a></td>',u.join(" "),f,S,l.getTime(),c.getTime(),w)),w%2===0&&w!=E&&o.push("</tr><tr>")}o.push("</tr>"),r.find("table.UTableBorder tbody").html($(o.join("")))},updateSelected:function(e){var t=this,n,r,i;if(!e)i=this._model.selectedDate(),i&&(n=i.start,r=i.end);else{e=$(e),i=JC.f.getJqParent(e,"td");if(i&&i.hasClass("unable"))return;n=new Date,r=new Date,n.setTime(e.attr("dstart")),r.setTime(e.attr("dend"))}if(!n||!r)return;t._model.selector().val(t._model.fullFormat(t._model.dateFormat(n),t._model.dateFormat(r))),$(t).trigger("TriggerEvent",[JC.Calendar.Model.UPDATE,"season",n,r]),JC.Calendar.hide()}}),$(document).delegate(["input[datatype=season]","input[multidate=season]"].join(),"focus",function(e){Calendar.pickDate(this)}),$(document).delegate(["button[datatype=season]","button[multidate=season]"].join(),"click",function(e){Calendar.pickDate(this)}),$(document).delegate(["textarea[datatype=season]","textarea[multidate=season]"].join(),"click",function(e){Calendar.pickDate(this)}),JC.Calendar})})(typeof define=="function"&&define.amd?define:function(e,t,n){typeof e=="function"&&(n=e),typeof t=="function"&&(n=t),n&&n()},window);