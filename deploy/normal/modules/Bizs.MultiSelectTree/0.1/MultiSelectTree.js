(function(e,t){e("Bizs.MultiSelectTree",["JC.common","JC.Tree"],function(){function e(e,t,n,r){this._tree=new JC.Tree(e,t),this._getSelected=n,this._renderTpl=r}return JC.use&&!JC.Tree&&JC.use("JC.Tree"),Bizs.MultiSelectTree=e,e.prototype={expandChild:function(e){var t=$(e.target),n=t.attr("dataid");if(this._tree._model.hasChild(n)){this._tree._view.open(n);var r=this._tree._model.child(n);for(var i=0;i<r.length;i++)this.expandChild(r[i][0])}},foldChild:function(e){var t=$(e.target),n=t.attr("dataid");this._tree._view.close(n)},autoCheck:function(e){if(e.attr("dataid")==this._tree._model.root()[0])return;var t=JC.f.getJqParent(e,"ul"),n=t.find("input.js_checkbox:not(:checked)").length,r=t.prev().find("input.js_checkbox").eq(0);n===0?(r[0].checked=!0,this.autoCheck(r)):(r[0].checked=!1,this.autoCheck(r))},update:function(e){var t=$(e.target);if(t[0].nodeName.toLowerCase()!=="input")return;if(t[0].checked){var n=JC.f.getJqParent(t,"div.node_ctn").next().find("input.js_checkbox");for(var r=0;r<n.length;r++)n[r].checked=!0}else{var n=JC.f.getJqParent(t,"div.node_ctn").next().find("input.js_checkbox");for(var r=0;r<n.length;r++)n[r].checked=!1}this.autoCheck(t);var i=[];this._tree._model._container.find("input.js_checkbox:checked").each(function(){i.push($(this).attr("dataid"))}),this._getSelected(i,this._tree)},init:function(){var e=this;return this._tree._model._container.delegate("input.js_checkbox:checked","click",this.expandChild.bind(this)),this._tree._model._container.delegate("input.js_checkbox:not(:checked)","click",this.foldChild.bind(this)),this._tree.on("RenderLabel",function(t){var n=$(this);n.html(JC.f.printf(e._renderTpl||'<label dataid="{0}" dataname="{1}"><input type="checkbox" class="js_checkbox" dataid="{0}">{1}</label>',t[0],t[1]))}),this._tree.on("change",this.update.bind(this)),this._tree.init(),this._tree},tree:function(){return this._tree}},JC.MultiSelectTree})})(typeof define=="function"&&define.amd?define:function(e,t,n){typeof e=="function"&&(n=e),typeof t=="function"&&(n=t),n&&n()},window);